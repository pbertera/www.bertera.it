<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://www.bertera.it/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://www.bertera.it/theme/pygments/default.min.css">
  <link rel="stylesheet" type="text/css" href="http://www.bertera.it/theme/font-awesome/css/font-awesome.min.css">


    <link href="http://www.bertera.it/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Pietro Bertera's Blog Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#ff3333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#ff3333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="admin" />
<meta name="description" content="Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..." />
<meta name="keywords" content="decoding, dhcp, encapsulated options, encoding, python, rfc2132">
<meta property="og:site_name" content="Pietro Bertera's Blog"/>
<meta property="og:title" content="Encoding and decoding Encapsulated DHCP options (RFC 2132)"/>
<meta property="og:description" content="Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://www.bertera.it/encoding-and-decoding-encapsulated-dhcp-options-rfc-2132.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2012-10-19 10:38:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://www.bertera.it/author/admin.html">
<meta property="article:section" content="Python"/>
<meta property="article:tag" content="decoding"/>
<meta property="article:tag" content="dhcp"/>
<meta property="article:tag" content="encapsulated options"/>
<meta property="article:tag" content="encoding"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="rfc2132"/>
<meta property="og:image" content="//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120">
  <title>Pietro Bertera's Blog &ndash; Encoding and decoding Encapsulated DHCP options (RFC 2132)</title>
</head>
<body>
  <aside>
    <div>
      <a href="http://www.bertera.it">
        <img src="//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120" alt="Pietro Bertera" title="Pietro Bertera">
      </a>
      <h1><a href="http://www.bertera.it">Pietro Bertera</a></h1>
<p>Something about ...</p>      <nav>
        <ul class="list">
          <li><a href="http://www.bertera.it/pages/about.html#about">About</a></li>
          <li><a href="http://www.bertera.it/pages/contact.html#contact">Contact</a></li>
        </ul>
      </nav>
      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/pietrobertera" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/pbertera" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-twitter" href="https://twitter.com/pbertera" target="_blank"><i class="fa fa-twitter"></i></a></li>
        <li><a class="sc-rss" href="//bertera.it/feeds/all.atom.xml" target="_blank"><i class="fa fa-rss"></i></a></li>
      </ul>
    </div>
  </aside>
  <main>
    <nav>
      <a href="http://www.bertera.it">Home</a>
      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>
      <a href="http://www.bertera.it/feeds/all.atom.xml">Atom</a>
    </nav>

<article>
  <header>
    <h1 id="encoding-and-decoding-encapsulated-dhcp-options-rfc-2132">Encoding and decoding Encapsulated DHCP options (RFC 2132)</h1>
    <p>Posted on Fri 19 October 2012 in <a href="http://www.bertera.it/category/python.html">Python</a></p>
  </header>
  <div>
    <p>Vendor specific DHCP options may be provided encapsulated in DHCP option
43.<br />
With <a href="https://github.com/pbertera/junk/tree/master/dhcp-encapsulated-options">this little script</a> you
can encode and decode vendor encapsulated option according to <a href="http://www.ietf.org/rfc/rfc2132.txt">RFC
2132</a>.</p>
<p>For example with this command you can tunnel options 66 (TFTP Server),
67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS):</p>
<div class="highlight"><pre><span></span>$ ./dhcp-encapsulated-options.py encode <span class="m">66</span> http://provisionig.example.com <span class="m">67</span> settings.xml <span class="m">132</span> <span class="m">33</span> <span class="m">133</span> <span class="m">6</span>
Encoding part <span class="m">1</span>: http://provisionig.example.com
 Option ID: <span class="m">66</span>
 Option length: <span class="m">30</span>
 Encoded Option part: <span class="m">42</span>:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D

Encoding part <span class="m">2</span>: settings.xml
 Option ID: <span class="m">67</span>
 Option length: <span class="m">12</span>
 Encoded Option part: <span class="m">43</span>:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C

Encoding part <span class="m">3</span>: <span class="m">33</span>
 Option ID: <span class="m">132</span>
 Option length: <span class="m">2</span>
 Encoded Option part: <span class="m">84</span>:02:33:33

Encoding part <span class="m">4</span>: <span class="m">6</span>
 Option ID: <span class="m">133</span>
 Option length: <span class="m">1</span>
 Encoded Option part: <span class="m">85</span>:01:36

Full encoded options: <span class="m">42</span>:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D:43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C:84:02:33:33:85:01:36
</pre></div>


<p>And then you can add the encoded options in you dhcpd config file:</p>
<div class="highlight"><pre><span></span><span class="err">host device.labo.local {  </span>
<span class="err">    hardware ethernet 01:04:23:3b:d0:21;  </span>
<span class="err">    fixed-address 172.16.18.30;  </span>
<span class="err">    option vendor-encapsulated-options</span>
<span class="err">    42:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D:43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C:84:02:33:33:85:01:36;  </span>
<span class="err">}</span>
</pre></div>


<p>And viceversa you can decode an encapsulated option:</p>
<div class="highlight"><pre><span></span>$ ./dhcp-encapsulated-options.py decode <span class="m">42</span>:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D:43:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C
Decoding part <span class="m">1</span>: <span class="m">42</span>:1E:68:74:74:70:3A:2F:2F:70:72:6F:76:69:73:69:6F:6E:69:67:2E:65:78:61:6D:70:6C:65:2E:63:6F:6D
 Option ID: <span class="m">66</span>
 Option lenght: <span class="m">30</span>
 Option value: <span class="s2">&quot;http://provisionig.example.com&quot;</span>

Decoding part <span class="m">2</span>: <span class="m">43</span>:0C:73:65:74:74:69:6E:67:73:2E:78:6D:6C
 Option ID: <span class="m">67</span>
 Option lenght: <span class="m">12</span>
 Option value: <span class="s2">&quot;settings.xml&quot;</span>

End of encoded options
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://www.bertera.it/tag/decoding.html">decoding</a>
      <a href="http://www.bertera.it/tag/dhcp.html">dhcp</a>
      <a href="http://www.bertera.it/tag/encapsulated-options.html">encapsulated options</a>
      <a href="http://www.bertera.it/tag/encoding.html">encoding</a>
      <a href="http://www.bertera.it/tag/python.html">python</a>
      <a href="http://www.bertera.it/tag/rfc2132.html">rfc2132</a>
    </p>
  </div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'bertera-it';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</article>

    <footer>
<p>
  &copy; Pietro Bertera 2016 - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>
</p>
<p>Built using <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a></p><p>
  <a rel="license"
     href="http://creativecommons.org/licenses/by-sa/4.0/"
     target="_blank">
    <img alt="Creative Commons License"
         title="Creative Commons License"
         style="border-width:0"
         src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
         width="80"
         height="15"/>
  </a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Pietro Bertera's Blog ",
  "url" : "http://www.bertera.it",
  "image": "//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120",
  "description": "Pietro Bertera's Thoughts and Writings"
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "name": "Encoding and decoding Encapsulated DHCP options (RFC 2132)",
  "headline": "Encoding and decoding Encapsulated DHCP options (RFC 2132)",
  "datePublished": "2012-10-19 10:38:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "admin",
    "url": "http://www.bertera.it/author/admin.html"
  },
  "image": "//s.gravatar.com/avatar/f64fc3d41c2a8368feff0b7672ca7571?s=120",
  "url": "http://www.bertera.it/encoding-and-decoding-encapsulated-dhcp-options-rfc-2132.html",
  "description": "Vendor specific DHCP options may be provided encapsulated in DHCP option 43. With this little script you can encode and decode vendor encapsulated option according to RFC 2132. For example with this command you can tunnel options 66 (TFTP Server), 67 (TFTP Path), 132 (VLAN ID) and 133 (VLAN QOS ..."
}
</script></body>
</html>